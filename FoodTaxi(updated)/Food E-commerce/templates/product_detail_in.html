<!-- product_detail.html -->
<div class="modal-overlay" id="productOverlay">
  <div class="modal" id="productModal">
    <span class="close-btn">V</span>
    <img id="modalImage" src="" alt="Product Image" />
    <h3 id="modalName"></h3>
    <p id="modalCategory"></p>
    <p id="modalPrice"></p>
    <!-- Ratings added -->
    <div class="modal-rating" id="modalRating">★★★★☆</div>
    <p id="modalDescription"></p>

    <!-- Buttons -->
    <form id="addToCartForm">
      <input type="hidden" name="product_id" id="modalProductId" />
      <input type="hidden" name="quantity" value="1" />
      <button type="submit" class="buy-now">Buy now</button>
      <button type="submit" class="add-to-cart">Add to Cart</button>
    </form>
  </div>
  <script>
    const addToCartForm = document.getElementById("addToCartForm");
    const cartBadge = document.querySelector(".cart-badge");

    addToCartForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const formData = new FormData(addToCartForm);

      const response = await fetch("/add_to_cart", {
        method: "POST",
        body: formData,
      });

      if (response.ok) {
        let count = parseInt(cartBadge.textContent) || 0;
        cartBadge.textContent = count + 1;
      } else {
        alert("Error adding to cart.");
      }
    });
  </script>
</div>
